<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Compute markers used for publication &#8212; NICE 0.1.dev1 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>







  </head><body>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          NICE</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.dev1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="index.html">Examples</a></li>
                <li><a href="../auto_tutorials/index.html">Tutorials</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="https://github.com/nice-tools/nice">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Compute markers used for publication</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/auto_examples/plot_compute_doc_forest_markers.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><ul>
<li><a class="reference internal" href="#">Compute markers used for publication</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-compute-doc-forest-markers-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="compute-markers-used-for-publication">
<span id="sphx-glr-auto-examples-plot-compute-doc-forest-markers-py"></span><h1>Compute markers used for publication<a class="headerlink" href="#compute-markers-used-for-publication" title="Permalink to this headline">¶</a></h1>
<p>Here we compute the markers used for the diagnosis of DOC patients [1] for
an EGI recording from a control subject.</p>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Engemann D.A.*, Raimondo F.*, King JR., Rohaut B., Louppe G.,
Faugeras F., Annen J., Cassol H., Gosseries O., Fernandez-Slezak D.,
Laureys S., Naccache L., Dehaene S. and Sitt J.D. (2018).
Robust EEG-based cross-site and cross-protocol classification of
states of consciousness. Brain. doi:10.1093/brain/awy251</td></tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Denis A. Engemann &lt;denis.engemann@gmail.com&gt;</span>
<span class="c1">#          Federico Raimondo &lt;federaimondo@gmail.com&gt;</span>

<span class="kn">import</span> <span class="nn">os.path</span> <span class="kn">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">mne</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">nice</span> <span class="kn">import</span> <span class="n">Markers</span>
<span class="kn">from</span> <span class="nn">nice.markers</span> <span class="kn">import</span> <span class="p">(</span><span class="n">PowerSpectralDensity</span><span class="p">,</span>
                          <span class="n">KolmogorovComplexity</span><span class="p">,</span>
                          <span class="n">PermutationEntropy</span><span class="p">,</span>
                          <span class="n">SymbolicMutualInformation</span><span class="p">,</span>
                          <span class="n">PowerSpectralDensitySummary</span><span class="p">,</span>
                          <span class="n">PowerSpectralDensityEstimator</span><span class="p">,</span>
                          <span class="n">ContingentNegativeVariation</span><span class="p">,</span>
                          <span class="n">TimeLockedTopography</span><span class="p">,</span>
                          <span class="n">TimeLockedContrast</span><span class="p">)</span>


<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;./data/JSXXX-epo.fif&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;File not present, downloading...&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">urllib.request</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://ndownloader.figshare.com/files/13179518&#39;</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Download complete&#39;</span><span class="p">)</span>

<span class="n">epochs</span> <span class="o">=</span> <a href="http://martinos.org/mne/stable/generated/mne.read_epochs.html#mne.read_epochs" title="View documentation for mne.read_epochs"><span class="n">mne</span><span class="o">.</span><span class="n">read_epochs</span></a><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="n">psds_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n_fft</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">n_overlap</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>


<span class="n">base_psd</span> <span class="o">=</span> <span class="n">PowerSpectralDensityEstimator</span><span class="p">(</span>
    <span class="n">psd_method</span><span class="o">=</span><span class="s1">&#39;welch&#39;</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span>
    <span class="n">psd_params</span><span class="o">=</span><span class="n">psds_params</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

<span class="c1"># Note that the psd is shared by all `PowerSpectralDensity` markers.</span>
<span class="c1"># To save time, the PSD will not be re-computed.</span>
<span class="c1"># When making another set of marker, also recompute the base_psd explicitly.</span>


<span class="n">m_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;delta&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;deltan&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">8.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">8.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;thetan&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">8.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">12.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">8.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">12.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;alphan&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">12.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;beta&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">12.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;betan&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;gamman&#39;</span><span class="p">),</span>

    <span class="n">PowerSpectralDensity</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span>
                         <span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;summary_se&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensitySummary</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span>
                                <span class="n">percentile</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;summary_msf&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensitySummary</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span>
                                <span class="n">percentile</span><span class="o">=.</span><span class="mi">9</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;summary_sef90&#39;</span><span class="p">),</span>
    <span class="n">PowerSpectralDensitySummary</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_psd</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span>
                                <span class="n">percentile</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;summary_sef95&#39;</span><span class="p">),</span>

    <span class="n">PermutationEntropy</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">),</span>

    <span class="n">SymbolicMutualInformation</span><span class="p">(</span>
        <span class="n">tmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;openmp&#39;</span><span class="p">,</span>
        <span class="n">method_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nthreads&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">},</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">),</span>

    <span class="n">KolmogorovComplexity</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;openmp&#39;</span><span class="p">,</span>
                         <span class="n">method_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nthreads&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">}),</span>

    <span class="c1"># Evokeds</span>
    <span class="n">ContingentNegativeVariation</span><span class="p">(</span><span class="n">tmin</span><span class="o">=-</span><span class="mf">0.004</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.596</span><span class="p">),</span>

    <span class="n">TimeLockedTopography</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="mf">0.064</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.112</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;p1&#39;</span><span class="p">),</span>
    <span class="n">TimeLockedTopography</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="mf">0.876</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.936</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;p3a&#39;</span><span class="p">),</span>
    <span class="n">TimeLockedTopography</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="mf">0.996</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">1.196</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;p3b&#39;</span><span class="p">),</span>

    <span class="n">TimeLockedContrast</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">condition_a</span><span class="o">=</span><span class="s1">&#39;LSGS&#39;</span><span class="p">,</span>
                       <span class="n">condition_b</span><span class="o">=</span><span class="s1">&#39;LDGD&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;LSGS-LDGD&#39;</span><span class="p">),</span>

    <span class="n">TimeLockedContrast</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">condition_a</span><span class="o">=</span><span class="s1">&#39;LSGD&#39;</span><span class="p">,</span>
                       <span class="n">condition_b</span><span class="o">=</span><span class="s1">&#39;LDGS&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;LSGD-LDGS&#39;</span><span class="p">),</span>

    <span class="n">TimeLockedContrast</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">condition_a</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LDGS&#39;</span><span class="p">,</span> <span class="s1">&#39;LDGD&#39;</span><span class="p">],</span>
                       <span class="n">condition_b</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LSGS&#39;</span><span class="p">,</span> <span class="s1">&#39;LSGD&#39;</span><span class="p">],</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;LD-LS&#39;</span><span class="p">),</span>

    <span class="n">TimeLockedContrast</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="mf">0.736</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.788</span><span class="p">,</span> <span class="n">condition_a</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LDGS&#39;</span><span class="p">,</span> <span class="s1">&#39;LDGD&#39;</span><span class="p">],</span>
                       <span class="n">condition_b</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LSGS&#39;</span><span class="p">,</span> <span class="s1">&#39;LSGD&#39;</span><span class="p">],</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;mmn&#39;</span><span class="p">),</span>

    <span class="n">TimeLockedContrast</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="mf">0.876</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.936</span><span class="p">,</span> <span class="n">condition_a</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LDGS&#39;</span><span class="p">,</span> <span class="s1">&#39;LDGD&#39;</span><span class="p">],</span>
                       <span class="n">condition_b</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LSGS&#39;</span><span class="p">,</span> <span class="s1">&#39;LSGD&#39;</span><span class="p">],</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;p3a&#39;</span><span class="p">),</span>

    <span class="n">TimeLockedContrast</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">condition_a</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LSGD&#39;</span><span class="p">,</span> <span class="s1">&#39;LDGD&#39;</span><span class="p">],</span>
                       <span class="n">condition_b</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LSGS&#39;</span><span class="p">,</span> <span class="s1">&#39;LDGS&#39;</span><span class="p">],</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;GD-GS&#39;</span><span class="p">),</span>

    <span class="n">TimeLockedContrast</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="mf">0.996</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">1.196</span><span class="p">,</span> <span class="n">condition_a</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LSGD&#39;</span><span class="p">,</span> <span class="s1">&#39;LDGD&#39;</span><span class="p">],</span>
                       <span class="n">condition_b</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LSGS&#39;</span><span class="p">,</span> <span class="s1">&#39;LDGS&#39;</span><span class="p">],</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;p3b&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">mc</span> <span class="o">=</span> <span class="n">Markers</span><span class="p">(</span><span class="n">m_list</span><span class="p">)</span>

<span class="n">mc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;data/JSXXX-markers.hdf5&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Reading ./data/JSXXX-epo.fif ...
    Read a total of 2 projection items:
        Average EEG reference (1 x 250) active
        Average EEG reference (1 x 256) active
    Found the data of interest:
        t =    -200.00 ...    1340.00 ms
        0 CTF compensation matrices available
616 matching events found
Applying baseline correction (mode: mean)
Created an SSP operator (subspace dimension = 2)
616 matching events found
Applying baseline correction (mode: mean)
Not setting metadata
Created an SSP operator (subspace dimension = 2)
2 projection items activated
Fitting nice/marker/PowerSpectralDensity/delta
Autodetected number of jobs 8
Effective window size : 16.384 (s)
Fitting nice/marker/PowerSpectralDensity/deltan
Fitting nice/marker/PowerSpectralDensity/theta
Fitting nice/marker/PowerSpectralDensity/thetan
Fitting nice/marker/PowerSpectralDensity/alpha
Fitting nice/marker/PowerSpectralDensity/alphan
Fitting nice/marker/PowerSpectralDensity/beta
Fitting nice/marker/PowerSpectralDensity/betan
Fitting nice/marker/PowerSpectralDensity/gamma
Fitting nice/marker/PowerSpectralDensity/gamman
Fitting nice/marker/PowerSpectralDensity/summary_se
Fitting nice/marker/PowerSpectralDensitySummary/summary_msf
Fitting nice/marker/PowerSpectralDensitySummary/summary_sef90
Fitting nice/marker/PowerSpectralDensitySummary/summary_sef95
Fitting nice/marker/PermutationEntropy/default
Filtering  at 10.42 Hz
Fitting nice/marker/SymbolicMutualInformation/weighted
Autodetected number of jobs 2
Computing CSD
Using EGI 256 locations for CSD
Using 2 jobs
Filtering  at 10.42 Hz
Autodetected number of threads 4
Fitting nice/marker/KolmogorovComplexity/default
Running KolmogorovComplexity
Autodetected number of threads 4
Elapsed time 2.3484690189361572 sec
Fitting nice/marker/ContingentNegativeVariation/default
Fitting nice/marker/TimeLockedTopography/p1
Fitting nice/marker/TimeLockedTopography/p3a
Fitting nice/marker/TimeLockedTopography/p3b
Fitting nice/marker/TimeLockedContrast/LSGS-LDGD
Fitting nice/marker/TimeLockedContrast/LSGD-LDGS
Fitting nice/marker/TimeLockedContrast/LD-LS
Fitting nice/marker/TimeLockedContrast/mmn
Fitting nice/marker/TimeLockedContrast/p3a
Fitting nice/marker/TimeLockedContrast/GD-GS
Fitting nice/marker/TimeLockedContrast/p3b
Writing channel info to HDF5 file
Writing PSDS Estimator to HDF5 file
Channel info already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
PSDS Estimator already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Writing epochs to HDF5 file
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
Channel info already present in HDF5 file, will not be overwritten
Epochs already present in HDF5 file, will not be overwritten
</pre></div>
</div>
<p>Let’s explore a bit the PSDs used for the marker computation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">psd</span> <span class="o">=</span> <span class="n">base_psd</span><span class="o">.</span><span class="n">data_</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">base_psd</span><span class="o">.</span><span class="n">freqs_</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.mean" title="View documentation for numpy.mean"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">psd</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;log(psd)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># We clearly see alpha and beta band peaks.</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_compute_doc_forest_markers_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_compute_doc_forest_markers_001.png" />
<p><strong>Total running time of the script:</strong> ( 2 minutes  5.099 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-compute-doc-forest-markers-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/a45f7cb872eaed35a536ac7c8a125c3e/plot_compute_doc_forest_markers.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_compute_doc_forest_markers.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/2424c82664ffd915335d987086e5c720/plot_compute_doc_forest_markers.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_compute_doc_forest_markers.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Denis A. Engemann.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>